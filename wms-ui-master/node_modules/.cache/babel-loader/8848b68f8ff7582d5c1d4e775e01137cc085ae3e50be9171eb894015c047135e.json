{"ast":null,"code":"import $http from \"@/http/base\";\nexport function formatDate(date) {\n  let time = new Date(date);\n  let year = time.getFullYear();\n  let month = time.getMonth() + 1;\n  month = month.toString().padStart(2, \"0\");\n  let day = time.getDate().toString().padStart(2, \"0\");\n  return year + \"年\" + month + \"月\" + day + \"日\";\n}\nexport default {\n  data() {\n    return {\n      activeIndex: \"1\",\n      formInline: {\n        dh: \"\",\n        lx: \"\",\n        mc: \"\",\n        date: \"\",\n        bei: \"\",\n        jbr: \"\",\n        zt: \"\",\n        datek: \"\"\n      },\n      tableData: [],\n      tableData1: [],\n      tableData2: [],\n      tableData3: [],\n      ii: \"\",\n      currentPage: 1,\n      //当前页\n      pagesize: 4,\n      //每页显示数\n      rows: 0,\n      //总行数\n      str: \"1=1\",\n      multipleSelection: [],\n      yrksl: 0,\n      zje: 0,\n      activeName: \"first\"\n    };\n  },\n  methods: {\n    truncateString(str, length) {\n      return str.length > length ? str.slice(0, length) + \"...\" : str;\n    },\n    zt(i) {\n      if (i == 0) return \"无盈亏\";\n      if (i == 1) return \"有盈亏\";\n    },\n    //每页显示数改变事件\n    handleSizeChange(size) {\n      this.pagesize = size;\n      this.currentPage = 1;\n      this.FenYe();\n    },\n    //页码改变事件\n    handleCurrentChange(page) {\n      this.currentPage = page;\n      this.FenYe();\n    },\n    FenYe() {\n      var t = this;\n      t.str = \"AuditDH='\" + this.$route.query.dh + \"'\";\n      $http.post(\"http://localhost:5149/api/Wh_inbill_h/FenAudit?page=\" + t.pagesize + \"&pageSize=\" + t.currentPage + \"&str=\" + t.str).then(res => {\n        t.tableData2 = res.list;\n        t.rows = res.rows;\n        console.log(this.tableData2);\n      }).catch(err => {\n        alert(err);\n      });\n    },\n    //关闭\n    gb() {\n      this.$router.go(-1);\n    },\n    fzcg() {\n      this.$message({\n        message: \"复制成功\",\n        type: \"success\"\n      });\n    },\n    //下标\n    handleSelect(key, keyPath) {\n      console.log(key, keyPath);\n    },\n    //选择\n    handleSelectionChange(val) {\n      this.multipleSelection = val;\n      console.log(this.multipleSelection);\n    },\n    Jia() {\n      var bh = this.$route.query.dh;\n      $http.get(\"  http://localhost:5149/api/Wh_inventory_h/Wh_inventory_hMH?bh=\" + bh).then(res => {\n        this.formInline.dh = res.inventory_code;\n        this.formInline.lx = res.inventory_type;\n        this.formInline.mc = res.ware_code;\n        this.formInline.date = res.end_date;\n        this.formInline.datek = res.begin_date;\n        this.formInline.bei = res.remark;\n        this.formInline.zt = res.zt;\n        this.formInline.jbr = res.sure_man;\n      }).catch(err => {\n        alert(err);\n      });\n    },\n    //明细\n    find() {\n      var bh = this.$route.query.dh;\n      var s1 = 0; //账面库存\n      var s2 = 0; //盘点数量\n      var s3 = 0; //盘盈数量\n      var s4 = 0; //盘亏数量\n      var s5 = 0; //账面金额\n      var s6 = 0; //盘点金额\n      var s7 = 0; //盘盈金额\n      var s8 = 0; //盘亏金额\n\n      $http.get(\"  http://localhost:5149/api/Wh_inventory_h/Wh_inventory_dMH?bh=\" + bh).then(res => {\n        this.tableData = res;\n        for (let i = 0; i < this.tableData.length; i++) {\n          s1 += this.tableData[i].account_num;\n          s2 += this.tableData[i].inventory_num;\n          s5 += this.tableData[i].account_num * this.tableData[i].inbill_price;\n          s6 += this.tableData[i].inventory_num * this.tableData[i].inbill_price;\n          if (this.tableData[i].break_even_num > 0) {\n            s3 += this.tableData[i].break_even_num;\n            s7 += this.tableData[i].break_even_num * this.tableData[i].inbill_price;\n          }\n          if (this.tableData[i].break_even_num < 0) {\n            s4 += this.tableData[i].break_even_num;\n            s8 += this.tableData[i].break_even_num * this.tableData[i].inbill_price;\n          }\n        }\n        document.getElementById(\"sumNumber\").innerHTML = s2; //盘点数量\n        document.getElementById(\"sumKu\").innerHTML = s1; //账面库存\n        document.getElementById(\"sumJin\").innerHTML = s5; //账面金额\n        document.getElementById(\"sumSalary\").innerHTML = s6; //盘点金额\n        document.getElementById(\"sumNumbery\").innerHTML = s3; //盘盈数量\n        document.getElementById(\"sumNumberk\").innerHTML = s4; //盘亏数量\n        document.getElementById(\"sumSalaryy\").innerHTML = s7; //盘盈金额\n        document.getElementById(\"sumSalaryk\").innerHTML = s8; //盘亏金额\n      }).catch(err => {\n        alert(err);\n      });\n      $http.post(\"http://localhost:5149/api/Wh_inbill_h/Fen?page=4&pageSize=1&str=inbill_bh='\" + bh + \"'\").then(res => {\n        this.tableData1 = res.list;\n      }).catch(err => {\n        alert(err);\n      });\n      $http.post(\"http://localhost:5149/api/Wh_outbill_h/Fen?page=4&pageSize=1&str=outbill_code='\" + bh + \"'\").then(res => {\n        this.tableData3 = res.list;\n      }).catch(err => {\n        alert(err);\n      });\n    },\n    //时间格式化\n    filterTime(timestamp) {\n      return formatDate(timestamp);\n    },\n    handleClick(tab, event) {\n      console.log(tab, event);\n    }\n  },\n  mounted() {\n    this.Jia();\n    this.find();\n    this.FenYe();\n  }\n};","map":{"version":3,"names":["$http","formatDate","date","time","Date","year","getFullYear","month","getMonth","toString","padStart","day","getDate","data","activeIndex","formInline","dh","lx","mc","bei","jbr","zt","datek","tableData","tableData1","tableData2","tableData3","ii","currentPage","pagesize","rows","str","multipleSelection","yrksl","zje","activeName","methods","truncateString","length","slice","i","handleSizeChange","size","FenYe","handleCurrentChange","page","t","$route","query","post","then","res","list","console","log","catch","err","alert","gb","$router","go","fzcg","$message","message","type","handleSelect","key","keyPath","handleSelectionChange","val","Jia","bh","get","inventory_code","inventory_type","ware_code","end_date","begin_date","remark","sure_man","find","s1","s2","s3","s4","s5","s6","s7","s8","account_num","inventory_num","inbill_price","break_even_num","document","getElementById","innerHTML","filterTime","timestamp","handleClick","tab","event","mounted"],"sources":["src/components/DetaileWh_inventory_h.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <div id=\"addss\">\r\n      <h3 style=\"margin-left: 35px; padding-top: 30px; display: inline-block\">\r\n        盘点单号：{{ formInline.dh }}\r\n        <img\r\n          src=\"../Images/fz.png\"\r\n          width=\"20px\"\r\n          height=\"20px\"\r\n          style=\"vertical-align: middle; margin-left: 120px\"\r\n          @click=\"fzcg\"\r\n        />\r\n      </h3>\r\n\r\n      <div style=\"float: right; padding-top: 30px; margin-right: 35px\">\r\n        <!-- <el-button id=\"tex3\" @click=\"inserok()\" icon=\"el-icon-plus\">编辑</el-button> -->\r\n        <!-- <el-button  id=\"tex4\"  icon=\"el-icon-edit\">修改</el-button> -->\r\n        <el-button id=\"tex5\" @click=\"delAll()\" icon=\"el-icon-delete\"\r\n          >撤销</el-button\r\n        >\r\n        <el-button id=\"tex6\" icon=\"el-icon-download\">打印</el-button>\r\n      </div>\r\n\r\n      <table\r\n        style=\"\r\n          width: 1100px;\r\n          line-height: 55px;\r\n          margin-left: 35px;\r\n          padding-top: 20px;\r\n        \"\r\n      >\r\n        <tr>\r\n          <td>\r\n            盘点类型<i style=\"margin-left: 50px; color: #999999\">{{\r\n              formInline.lx\r\n            }}</i>\r\n          </td>\r\n\r\n          <td>\r\n            盘点开始时间<i style=\"margin-left: 50px; color: #999999\">{{\r\n              filterTime(formInline.datek)\r\n            }}</i>\r\n          </td>\r\n\r\n          <td>\r\n            仓库名称<i style=\"margin-left: 50px; color: #999999\">{{\r\n              formInline.mc\r\n            }}</i>\r\n          </td>\r\n\r\n          <td>\r\n            状态<i style=\"margin-left: 50px; font-weight: bold\">{{\r\n              zt(formInline.zt)\r\n            }}</i>\r\n          </td>\r\n        </tr>\r\n        <tr>\r\n          <td>\r\n            经办人<i style=\"margin-left: 50px; color: #999999\">{{\r\n              formInline.jbr\r\n            }}</i>\r\n          </td>\r\n          <td>\r\n            盘点结束时间<i style=\"margin-left: 50px; color: #999999\">{{\r\n              filterTime(formInline.date)\r\n            }}</i>\r\n          </td>\r\n        </tr>\r\n\r\n        <tr>\r\n          <td>\r\n            备注<i style=\"margin-left: 65px; color: #999999\">{{\r\n              formInline.bei\r\n            }}</i>\r\n          </td>\r\n        </tr>\r\n      </table>\r\n    </div>\r\n\r\n    <div id=\"addxx\">\r\n      <el-tabs id=\"menu\" v-model=\"activeName\" @tab-click=\"handleClick\">\r\n        <el-tab-pane label=\"盘点明细\" name=\"first\">\r\n          <el-button id=\"tex9\" icon=\"el-icon-download\">导出</el-button>\r\n          <el-table\r\n            tooltip-effect=\"dark\"\r\n            :data=\"tableData\"\r\n            height=\"300\"\r\n            :row-style=\"{ height: 70 + 'px' }\"\r\n            :header-cell-style=\"{\r\n              background: '#F8F8F9',\r\n              color: '#606266',\r\n              'text-align': 'center',\r\n            }\"\r\n            :cell-style=\"{ 'text-align': 'center' }\"\r\n            id=\"ttt\"\r\n            @selection-change=\"handleSelectionChange\"\r\n          >\r\n            <el-table-column type=\"selection\" width=\"55\"> </el-table-column>\r\n            <el-table-column label=\"序号\" fixed type=\"index\" width=\"50\">\r\n            </el-table-column>\r\n            <el-table-column prop=\"buy_code\" label=\"货品编号\" v-if=\"false\">\r\n            </el-table-column>\r\n\r\n            <el-table-column\r\n              fixed\r\n              prop=\"item_name\"\r\n              label=\"货品名称\"\r\n              width=\"100\"\r\n            >\r\n            </el-table-column>\r\n            <el-table-column fixed label=\"货品编号\" width=\"100\">\r\n              <template slot-scope=\"scope\">\r\n                <span :id=\"'hp' + (scope.$index + 1)\">{{\r\n                  scope.row.item_code\r\n                }}</span>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"item_type_name\" label=\"货品类型\" width=\"80\">\r\n            </el-table-column>\r\n            <el-table-column prop=\"model_code\" label=\"规格型号\" width=\"80\">\r\n            </el-table-column>\r\n            <el-table-column prop=\"unit\" label=\"单位\" width=\"80\">\r\n            </el-table-column>\r\n\r\n            <el-table-column label=\"账面库存\" width=\"80\">\r\n              <template slot-scope=\"scope\">\r\n                <span :id=\"'ku' + (scope.$index + 1)\">{{\r\n                  scope.row.account_num\r\n                }}</span>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"账面金额\" width=\"140\">\r\n              <template slot-scope=\"scope\">\r\n                <span :id=\"'jin' + (scope.$index + 1)\">{{\r\n                  scope.row.inbill_price * scope.row.account_num\r\n                }}</span>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"area_code\" label=\"盘点仓位\" width=\"140px\">\r\n            </el-table-column>\r\n            <el-table-column prop=\"inventory_num\" label=\"盘点数量\" width=\"140\">\r\n            </el-table-column>\r\n            <el-table-column label=\"盈亏数量\" width=\"140\">\r\n              <template slot-scope=\"scope\">\r\n                <span\r\n                  v-if=\"scope.row.break_even_num > 0\"\r\n                  style=\"color: green\"\r\n                  :id=\"'weiSum' + (scope.$index + 1)\"\r\n                  >{{ scope.row.break_even_num }}</span\r\n                >\r\n                <span\r\n                  v-if=\"scope.row.break_even_num < 0\"\r\n                  style=\"color: red\"\r\n                  :id=\"'weiSum' + (scope.$index + 1)\"\r\n                  >{{ scope.row.break_even_num }}</span\r\n                >\r\n                <span\r\n                  v-if=\"scope.row.break_even_num == 0\"\r\n                  style=\"color: black\"\r\n                  :id=\"'weiSum' + (scope.$index + 1)\"\r\n                  >{{ scope.row.break_even_num }}</span\r\n                >\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"盘点状态\" width=\"140\">\r\n              <template slot-scope=\"scope\">\r\n                <el-tag\r\n                  :id=\"'elTag' + (scope.$index + 1)\"\r\n                  v-if=\"scope.row.inventory_state == 0\"\r\n                  class=\"el-tag el-tag--light el-tag--primary\"\r\n                  disable-transitions\r\n                  >未盈亏</el-tag\r\n                >\r\n                <el-tag\r\n                  :id=\"'elTag' + (scope.$index + 1)\"\r\n                  v-if=\"scope.row.inventory_state == 1\"\r\n                  class=\"el-tag el-tag--light el-tag--danger\"\r\n                  disable-transitions\r\n                  >盘亏</el-tag\r\n                >\r\n                <el-tag\r\n                  :id=\"'elTag' + (scope.$index + 1)\"\r\n                  v-if=\"scope.row.inventory_state == 2\"\r\n                  class=\"el-tag el-tag--light el-tag--success\"\r\n                  disable-transitions\r\n                  >盘盈</el-tag\r\n                >\r\n              </template>\r\n            </el-table-column>\r\n\r\n            <el-table-column label=\"盘点金额\" width=\"140\">\r\n              <template slot-scope=\"scope\">\r\n                <span\r\n                  v-if=\"scope.row.break_even_num > 0\"\r\n                  style=\"color: green\"\r\n                  >{{ scope.row.break_even_num * scope.row.inbill_price }}</span\r\n                >\r\n                <span v-if=\"scope.row.break_even_num < 0\" style=\"color: red\">{{\r\n                  scope.row.break_even_num * scope.row.inbill_price\r\n                }}</span>\r\n                <span\r\n                  v-if=\"scope.row.break_even_num == 0\"\r\n                  style=\"color: black\"\r\n                  >{{ scope.row.break_even_num * scope.row.inbill_price }}</span\r\n                >\r\n              </template>\r\n            </el-table-column>\r\n\r\n            <el-table-column label=\"入库单价\" width=\"100\">\r\n              <template slot-scope=\"scope\">\r\n                <span :id=\"'saleSum' + (scope.$index + 1)\">{{\r\n                  scope.row.inbill_price\r\n                }}</span>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"入库金额\" width=\"100\">\r\n              <template slot-scope=\"scope\">\r\n                <i :id=\"'totalsum' + (scope.$index + 1)\" style=\"color: red\">{{\r\n                  scope.row.inbill_price * scope.row.inventory_num\r\n                }}</i>\r\n              </template>\r\n            </el-table-column>\r\n\r\n            <el-table-column prop=\"remark\" label=\"备注\" width=\"300\">\r\n            </el-table-column>\r\n          </el-table>\r\n          <div id=\"hj\">\r\n            <span style=\"line-height: 45px; font-size: 12px; margin-left: 25px\"\r\n              >合计</span\r\n            >\r\n            <p style=\"float: right\">\r\n              <span style=\"line-height: 45px; font-size: 14px\">账面库存：</span>\r\n              <span\r\n                style=\"\r\n                  line-height: 45px;\r\n                  font-weight: bold;\r\n                  color: red;\r\n                  font-size: 14px;\r\n                  margin-right: 25px;\r\n                \"\r\n                id=\"sumKu\"\r\n                >0</span\r\n              >\r\n              <span style=\"line-height: 45px; font-size: 14px\">账面金额：</span>\r\n              <span\r\n                style=\"\r\n                  line-height: 45px;\r\n                  font-weight: bold;\r\n                  color: red;\r\n                  font-size: 14px;\r\n                  margin-right: 25px;\r\n                \"\r\n                id=\"sumJin\"\r\n                >￥0.00</span\r\n              >\r\n              <span style=\"line-height: 45px; font-size: 14px\">盘点数量：</span>\r\n              <span\r\n                style=\"\r\n                  line-height: 45px;\r\n                  font-weight: bold;\r\n                  color: red;\r\n                  font-size: 14px;\r\n                  margin-right: 25px;\r\n                \"\r\n                id=\"sumNumber\"\r\n                >0</span\r\n              >\r\n              <span style=\"line-height: 45px; font-size: 14px\">盘点金额：</span>\r\n              <span\r\n                style=\"\r\n                  line-height: 45px;\r\n                  font-weight: bold;\r\n                  color: red;\r\n                  font-size: 14px;\r\n                  margin-right: 25px;\r\n                \"\r\n                id=\"sumSalary\"\r\n                >￥0.00</span\r\n              >\r\n              <span style=\"line-height: 45px; font-size: 14px\">盘盈数量：</span>\r\n              <span\r\n                style=\"\r\n                  line-height: 45px;\r\n                  font-weight: bold;\r\n                  color: red;\r\n                  font-size: 14px;\r\n                  margin-right: 25px;\r\n                \"\r\n                id=\"sumNumbery\"\r\n                >0</span\r\n              >\r\n              <span style=\"line-height: 45px; font-size: 14px\">盘亏数量：</span>\r\n              <span\r\n                style=\"\r\n                  line-height: 45px;\r\n                  font-weight: bold;\r\n                  color: red;\r\n                  font-size: 14px;\r\n                  margin-right: 25px;\r\n                \"\r\n                id=\"sumNumberk\"\r\n                >0</span\r\n              >\r\n              <span style=\"line-height: 45px; font-size: 14px\">盘盈金额：</span>\r\n              <span\r\n                style=\"\r\n                  line-height: 45px;\r\n                  font-weight: bold;\r\n                  color: red;\r\n                  font-size: 14px;\r\n                  margin-right: 25px;\r\n                \"\r\n                id=\"sumSalaryy\"\r\n                >￥0.00</span\r\n              >\r\n              <span style=\"line-height: 45px; font-size: 14px\">盘亏金额：</span>\r\n              <span\r\n                style=\"\r\n                  line-height: 45px;\r\n                  font-weight: bold;\r\n                  color: red;\r\n                  font-size: 14px;\r\n                  margin-right: 25px;\r\n                \"\r\n                id=\"sumSalaryk\"\r\n                >￥0.00</span\r\n              >\r\n            </p>\r\n          </div>\r\n        </el-tab-pane>\r\n        <el-tab-pane label=\"入库记录\" name=\"second\">\r\n          <el-button id=\"tex9\" icon=\"el-icon-download\">导出</el-button>\r\n\r\n          <el-table\r\n            tooltip-effect=\"dark\"\r\n            :data=\"tableData1\"\r\n            height=\"300\"\r\n            :row-style=\"{ height: 70 + 'px' }\"\r\n            :header-cell-style=\"{\r\n              background: '#F8F8F9',\r\n              color: '#606266',\r\n              'text-align': 'center',\r\n            }\"\r\n            :cell-style=\"{ 'text-align': 'center' }\"\r\n            id=\"ttt\"\r\n            @selection-change=\"handleSelectionChange\"\r\n          >\r\n            <el-table-column type=\"selection\" width=\"55\"> </el-table-column>\r\n\r\n            <el-table-column\r\n              fixed\r\n              prop=\"inbill_bh\"\r\n              label=\"入库单号\"\r\n              width=\"150\"\r\n            >\r\n            </el-table-column>\r\n            <el-table-column\r\n              fixed\r\n              prop=\"inbill_type\"\r\n              label=\"入库类型\"\r\n              width=\"120\"\r\n            >\r\n            </el-table-column>\r\n\r\n            <el-table-column fixed label=\"入库日期\" width=\"150\">\r\n              <template slot-scope=\"scope\">\r\n                <span>{{ filterTime(scope.row.inbll_date) }}</span>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"ware_name\" label=\"仓库名称\" width=\"120\">\r\n            </el-table-column>\r\n\r\n            <el-table-column prop=\"names\" label=\"入库货品\" width=\"180\">\r\n              <template slot-scope=\"scope\">\r\n                <el-popover placement=\"top\" trigger=\"hover\">\r\n                  <p>{{ scope.row.names }}</p>\r\n                  <div slot=\"reference\">\r\n                    {{ truncateString(scope.row.names, 10) }}\r\n                  </div>\r\n                </el-popover>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"inbill_duty_man\" label=\"经办人\" width=\"120\">\r\n            </el-table-column>\r\n            <el-table-column prop=\"total_buy_num\" label=\"入库数量\" width=\"120\">\r\n            </el-table-column>\r\n            <el-table-column prop=\"total_price\" label=\"入库金额\" width=\"120\">\r\n            </el-table-column>\r\n            <el-table-column prop=\"create_by\" label=\"制单人\" width=\"120\">\r\n            </el-table-column>\r\n            <el-table-column label=\"制单时间\" width=\"150\">\r\n              <template slot-scope=\"scope\">\r\n                <span>{{ filterTime(scope.row.create_time) }}</span>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </el-tab-pane>\r\n        <el-tab-pane label=\"出库记录\" name=\"third1\">\r\n          <el-button id=\"tex9\" icon=\"el-icon-download\">导出</el-button>\r\n\r\n          <el-table\r\n            tooltip-effect=\"dark\"\r\n            :data=\"tableData3\"\r\n            height=\"300\"\r\n            :row-style=\"{ height: 70 + 'px' }\"\r\n            :header-cell-style=\"{\r\n              background: '#F8F8F9',\r\n              color: '#606266',\r\n              'text-align': 'center',\r\n            }\"\r\n            :cell-style=\"{ 'text-align': 'center' }\"\r\n            id=\"ttt\"\r\n            @selection-change=\"handleSelectionChange\"\r\n          >\r\n            <el-table-column type=\"selection\" width=\"55\"> </el-table-column>\r\n\r\n            <el-table-column\r\n              fixed\r\n              prop=\"outbill_code\"\r\n              label=\"出库单号\"\r\n              width=\"150\"\r\n            >\r\n            </el-table-column>\r\n            <el-table-column\r\n              fixed\r\n              prop=\"outbill_type\"\r\n              label=\"出库类型\"\r\n              width=\"120\"\r\n            >\r\n            </el-table-column>\r\n\r\n            <el-table-column fixed label=\"出库日期\" width=\"150\">\r\n              <template slot-scope=\"scope\">\r\n                <span>{{ filterTime(scope.row.outbill_date) }}</span>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"ware_code\" label=\"仓库名称\" width=\"120\">\r\n            </el-table-column>\r\n\r\n            <el-table-column prop=\"names\" label=\"出库货品\" width=\"180\">\r\n              <template slot-scope=\"scope\">\r\n                <el-popover placement=\"top\" trigger=\"hover\">\r\n                  <p>{{ scope.row.names }}</p>\r\n                  <div slot=\"reference\">\r\n                    {{ truncateString(scope.row.names, 10) }}\r\n                  </div>\r\n                </el-popover>\r\n              </template>\r\n            </el-table-column>\r\n\r\n            <el-table-column prop=\"total_buy_num\" label=\"出库数量\" width=\"120\">\r\n            </el-table-column>\r\n            <el-table-column prop=\"total_price\" label=\"出库金额\" width=\"120\">\r\n            </el-table-column>\r\n            <el-table-column prop=\"duty_man\" label=\"经办人\" width=\"120\">\r\n            </el-table-column>\r\n            <el-table-column prop=\"create_by\" label=\"制单人\" width=\"120\">\r\n            </el-table-column>\r\n            <el-table-column label=\"制单时间\" width=\"150\">\r\n              <template slot-scope=\"scope\">\r\n                <span>{{ filterTime(scope.row.create_time) }}</span>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </el-tab-pane>\r\n        <el-tab-pane label=\"审核记录\" name=\"third\">\r\n          <el-table\r\n            tooltip-effect=\"dark\"\r\n            :data=\"tableData2\"\r\n            :header-cell-style=\"{\r\n              background: '#F8F8F9',\r\n              color: '#606266',\r\n              'text-align': 'center',\r\n            }\"\r\n            :cell-style=\"{ 'text-align': 'center' }\"\r\n            id=\"jhmx\"\r\n            height=\"300px\"\r\n          >\r\n            <el-table-column label=\"序号\" type=\"index\" width=\"70\">\r\n            </el-table-column>\r\n\r\n            <el-table-column label=\"审核结果\" width=\"300\">\r\n              <template slot-scope=\"scope\">\r\n                <span\r\n                  v-if=\"scope.row.auditResults == 0\"\r\n                  style=\"font-weight: 600; font-size: 13px\"\r\n                  >提交</span\r\n                >\r\n                <span\r\n                  v-if=\"scope.row.auditResults == 1\"\r\n                  style=\"color: red; font-weight: 600; font-size: 13px\"\r\n                  >驳回</span\r\n                >\r\n                <span\r\n                  v-if=\"scope.row.auditResults == 2\"\r\n                  style=\"color: green; font-weight: 600; font-size: 13px\"\r\n                  >已完成</span\r\n                >\r\n                <span\r\n                  v-if=\"scope.row.auditResults == 3\"\r\n                  style=\"font-weight: 600; font-size: 13px\"\r\n                  >撤销</span\r\n                >\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"opinions\" label=\"审核意见\" width=\"200\">\r\n            </el-table-column>\r\n            <el-table-column prop=\"auditUser\" label=\"操作人\" width=\"200\">\r\n            </el-table-column>\r\n\r\n            <el-table-column label=\"操作时间\" width=\"300\">\r\n              <template slot-scope=\"scope\">\r\n                <span v-if=\"scope.row.auditTime != '0001-01-01T00:00:00'\">{{\r\n                  filterTime(scope.row.auditTime)\r\n                }}</span>\r\n                <span v-else></span>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n\r\n          <!-- 分页 -->\r\n          <el-pagination\r\n            id=\"fenye\"\r\n            @size-change=\"handleSizeChange\"\r\n            @current-change=\"handleCurrentChange\"\r\n            :current-page=\"currentPage\"\r\n            :page-sizes=\"[4, 8, 12, 16]\"\r\n            :page-size=\"pagesize\"\r\n            layout=\"total, sizes, prev, pager, next, jumper\"\r\n            :total=\"rows\"\r\n          >\r\n          </el-pagination>\r\n        </el-tab-pane>\r\n      </el-tabs>\r\n    </div>\r\n    <div id=\"notification-container\">\r\n      <div id=\"dibu\">\r\n        <el-button id=\"bcccc\" @click=\"gb()\">关闭</el-button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport $http from \"@/http/base\";\r\nexport function formatDate(date) {\r\n  let time = new Date(date);\r\n\r\n  let year = time.getFullYear();\r\n\r\n  let month = time.getMonth() + 1;\r\n  month = month.toString().padStart(2, \"0\");\r\n  let day = time.getDate().toString().padStart(2, \"0\");\r\n  return year + \"年\" + month + \"月\" + day + \"日\";\r\n}\r\nexport default {\r\n  data() {\r\n    return {\r\n      activeIndex: \"1\",\r\n\r\n      formInline: {\r\n        dh: \"\",\r\n        lx: \"\",\r\n        mc: \"\",\r\n        date: \"\",\r\n        bei: \"\",\r\n        jbr: \"\",\r\n        zt: \"\",\r\n        datek: \"\",\r\n      },\r\n      tableData: [],\r\n      tableData1: [],\r\n      tableData2: [],\r\n      tableData3: [],\r\n      ii: \"\",\r\n      currentPage: 1, //当前页\r\n      pagesize: 4, //每页显示数\r\n      rows: 0, //总行数\r\n      str: \"1=1\",\r\n      multipleSelection: [],\r\n      yrksl: 0,\r\n\r\n      zje: 0,\r\n      activeName: \"first\",\r\n    };\r\n  },\r\n  methods: {\r\n    truncateString(str, length) {\r\n      return str.length > length ? str.slice(0, length) + \"...\" : str;\r\n    },\r\n    zt(i) {\r\n      if (i == 0) return \"无盈亏\";\r\n      if (i == 1) return \"有盈亏\";\r\n    },\r\n    //每页显示数改变事件\r\n    handleSizeChange(size) {\r\n      this.pagesize = size;\r\n      this.currentPage = 1;\r\n      this.FenYe();\r\n    },\r\n    //页码改变事件\r\n    handleCurrentChange(page) {\r\n      this.currentPage = page;\r\n      this.FenYe();\r\n    },\r\n    FenYe() {\r\n      var t = this;\r\n      t.str = \"AuditDH='\" + this.$route.query.dh + \"'\";\r\n      $http\r\n        .post(\r\n          \"http://localhost:5149/api/Wh_inbill_h/FenAudit?page=\" +\r\n            t.pagesize +\r\n            \"&pageSize=\" +\r\n            t.currentPage +\r\n            \"&str=\" +\r\n            t.str\r\n        )\r\n        .then((res) => {\r\n          t.tableData2 = res.list;\r\n          t.rows = res.rows;\r\n          console.log(this.tableData2);\r\n        })\r\n        .catch((err) => {\r\n          alert(err);\r\n        });\r\n    },\r\n    //关闭\r\n    gb() {\r\n      this.$router.go(-1);\r\n    },\r\n    fzcg() {\r\n      this.$message({\r\n        message: \"复制成功\",\r\n        type: \"success\",\r\n      });\r\n    },\r\n    //下标\r\n    handleSelect(key, keyPath) {\r\n      console.log(key, keyPath);\r\n    },\r\n    //选择\r\n    handleSelectionChange(val) {\r\n      this.multipleSelection = val;\r\n      console.log(this.multipleSelection);\r\n    },\r\n    Jia() {\r\n      var bh = this.$route.query.dh;\r\n\r\n      $http\r\n        .get(\r\n          \"  http://localhost:5149/api/Wh_inventory_h/Wh_inventory_hMH?bh=\" + bh\r\n        )\r\n        .then((res) => {\r\n          this.formInline.dh = res.inventory_code;\r\n\r\n          this.formInline.lx = res.inventory_type;\r\n          this.formInline.mc = res.ware_code;\r\n          this.formInline.date = res.end_date;\r\n          this.formInline.datek = res.begin_date;\r\n          this.formInline.bei = res.remark;\r\n          this.formInline.zt = res.zt;\r\n          this.formInline.jbr = res.sure_man;\r\n        })\r\n        .catch((err) => {\r\n          alert(err);\r\n        });\r\n    },\r\n    //明细\r\n    find() {\r\n      var bh = this.$route.query.dh;\r\n\r\n      var s1 = 0; //账面库存\r\n      var s2 = 0; //盘点数量\r\n      var s3 = 0; //盘盈数量\r\n      var s4 = 0; //盘亏数量\r\n      var s5 = 0; //账面金额\r\n      var s6 = 0; //盘点金额\r\n      var s7 = 0; //盘盈金额\r\n      var s8 = 0; //盘亏金额\r\n\r\n      $http\r\n        .get(\r\n          \"  http://localhost:5149/api/Wh_inventory_h/Wh_inventory_dMH?bh=\" + bh\r\n        )\r\n        .then((res) => {\r\n          this.tableData = res;\r\n          for (let i = 0; i < this.tableData.length; i++) {\r\n            s1 += this.tableData[i].account_num;\r\n            s2 += this.tableData[i].inventory_num;\r\n            s5 +=\r\n              this.tableData[i].account_num * this.tableData[i].inbill_price;\r\n            s6 +=\r\n              this.tableData[i].inventory_num * this.tableData[i].inbill_price;\r\n            if (this.tableData[i].break_even_num > 0) {\r\n              s3 += this.tableData[i].break_even_num;\r\n              s7 +=\r\n                this.tableData[i].break_even_num *\r\n                this.tableData[i].inbill_price;\r\n            }\r\n            if (this.tableData[i].break_even_num < 0) {\r\n              s4 += this.tableData[i].break_even_num;\r\n              s8 +=\r\n                this.tableData[i].break_even_num *\r\n                this.tableData[i].inbill_price;\r\n            }\r\n          }\r\n          document.getElementById(\"sumNumber\").innerHTML = s2; //盘点数量\r\n          document.getElementById(\"sumKu\").innerHTML = s1; //账面库存\r\n          document.getElementById(\"sumJin\").innerHTML = s5; //账面金额\r\n          document.getElementById(\"sumSalary\").innerHTML = s6; //盘点金额\r\n          document.getElementById(\"sumNumbery\").innerHTML = s3; //盘盈数量\r\n          document.getElementById(\"sumNumberk\").innerHTML = s4; //盘亏数量\r\n          document.getElementById(\"sumSalaryy\").innerHTML = s7; //盘盈金额\r\n          document.getElementById(\"sumSalaryk\").innerHTML = s8; //盘亏金额\r\n        })\r\n        .catch((err) => {\r\n          alert(err);\r\n        });\r\n\r\n      $http\r\n        .post(\r\n          \"http://localhost:5149/api/Wh_inbill_h/Fen?page=4&pageSize=1&str=inbill_bh='\" +\r\n            bh +\r\n            \"'\"\r\n        )\r\n        .then((res) => {\r\n          this.tableData1 = res.list;\r\n        })\r\n        .catch((err) => {\r\n          alert(err);\r\n        });\r\n\r\n      $http\r\n        .post(\r\n          \"http://localhost:5149/api/Wh_outbill_h/Fen?page=4&pageSize=1&str=outbill_code='\" +\r\n            bh +\r\n            \"'\"\r\n        )\r\n        .then((res) => {\r\n          this.tableData3 = res.list;\r\n        })\r\n        .catch((err) => {\r\n          alert(err);\r\n        });\r\n    },\r\n\r\n    //时间格式化\r\n    filterTime(timestamp) {\r\n      return formatDate(timestamp);\r\n    },\r\n    handleClick(tab, event) {\r\n      console.log(tab, event);\r\n    },\r\n  },\r\n  mounted() {\r\n    this.Jia();\r\n    this.find();\r\n    this.FenYe();\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n#hj {\r\n  border: 1px solid #eeeeee;\r\n  width: 1080px;\r\n  height: 45px;\r\n  margin-left: 2px;\r\n  display: inline-block;\r\n}\r\n\r\n.el-tabs__item {\r\n  padding: 0 20px;\r\n  height: 50px !important;\r\n  box-sizing: border-box;\r\n  line-height: 50px !important;\r\n  display: inline-block;\r\n  list-style: none;\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  color: #303133;\r\n  position: relative;\r\n}\r\n\r\n#menu {\r\n  position: relative;\r\n  left: 30px;\r\n  width: 1085px;\r\n}\r\n\r\n#jhmx {\r\n  width: 1080px !important;\r\n  margin-top: 25px;\r\n  margin-left: 2px;\r\n}\r\n\r\n#notification-container {\r\n  position: fixed;\r\n  bottom: 0;\r\n  width: 100%;\r\n  box-shadow: 0px -1px 7px rgba(0, 0, 0, 0.2);\r\n  background-color: #fff;\r\n  height: 60px;\r\n  z-index: 999;\r\n}\r\n\r\n#bcccc {\r\n  width: 28px !important;\r\n  color: #fff;\r\n  background-color: #9c27b0;\r\n  line-height: 28px !important;\r\n  width: 73px !important;\r\n  padding: 0px !important;\r\n  margin-left: 115px;\r\n}\r\n\r\n#addss {\r\n  border-radius: 5px;\r\n  background-color: #fff;\r\n  box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.2);\r\n  width: 1150px;\r\n  height: 330px;\r\n}\r\n\r\n#addxx {\r\n  margin-top: 20px;\r\n  border-radius: 5px;\r\n  background-color: #fff;\r\n  box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.2);\r\n  width: 1150px;\r\n  height: 580px;\r\n}\r\n\r\n#tex9 {\r\n  border: 1px solid #fae4a2;\r\n  color: #f8c341;\r\n  background-color: #fef8e8;\r\n  width: 28px !important;\r\n  line-height: 28px !important;\r\n  width: 73px !important;\r\n  padding: 0px !important;\r\n  margin-left: 2px;\r\n  margin-top: 25px;\r\n}\r\n\r\n#tex9:hover {\r\n  background-color: #f5bd41;\r\n  color: #fff;\r\n}\r\n</style>"],"mappings":"AAgiBA,OAAAA,KAAA;AACA,gBAAAC,WAAAC,IAAA;EACA,IAAAC,IAAA,OAAAC,IAAA,CAAAF,IAAA;EAEA,IAAAG,IAAA,GAAAF,IAAA,CAAAG,WAAA;EAEA,IAAAC,KAAA,GAAAJ,IAAA,CAAAK,QAAA;EACAD,KAAA,GAAAA,KAAA,CAAAE,QAAA,GAAAC,QAAA;EACA,IAAAC,GAAA,GAAAR,IAAA,CAAAS,OAAA,GAAAH,QAAA,GAAAC,QAAA;EACA,OAAAL,IAAA,SAAAE,KAAA,SAAAI,GAAA;AACA;AACA;EACAE,KAAA;IACA;MACAC,WAAA;MAEAC,UAAA;QACAC,EAAA;QACAC,EAAA;QACAC,EAAA;QACAhB,IAAA;QACAiB,GAAA;QACAC,GAAA;QACAC,EAAA;QACAC,KAAA;MACA;MACAC,SAAA;MACAC,UAAA;MACAC,UAAA;MACAC,UAAA;MACAC,EAAA;MACAC,WAAA;MAAA;MACAC,QAAA;MAAA;MACAC,IAAA;MAAA;MACAC,GAAA;MACAC,iBAAA;MACAC,KAAA;MAEAC,GAAA;MACAC,UAAA;IACA;EACA;EACAC,OAAA;IACAC,eAAAN,GAAA,EAAAO,MAAA;MACA,OAAAP,GAAA,CAAAO,MAAA,GAAAA,MAAA,GAAAP,GAAA,CAAAQ,KAAA,IAAAD,MAAA,YAAAP,GAAA;IACA;IACAV,GAAAmB,CAAA;MACA,IAAAA,CAAA;MACA,IAAAA,CAAA;IACA;IACA;IACAC,iBAAAC,IAAA;MACA,KAAAb,QAAA,GAAAa,IAAA;MACA,KAAAd,WAAA;MACA,KAAAe,KAAA;IACA;IACA;IACAC,oBAAAC,IAAA;MACA,KAAAjB,WAAA,GAAAiB,IAAA;MACA,KAAAF,KAAA;IACA;IACAA,MAAA;MACA,IAAAG,CAAA;MACAA,CAAA,CAAAf,GAAA,sBAAAgB,MAAA,CAAAC,KAAA,CAAAhC,EAAA;MACAhB,KAAA,CACAiD,IAAA,CACA,yDACAH,CAAA,CAAAjB,QAAA,GACA,eACAiB,CAAA,CAAAlB,WAAA,GACA,UACAkB,CAAA,CAAAf,GACA,EACAmB,IAAA,CAAAC,GAAA;QACAL,CAAA,CAAArB,UAAA,GAAA0B,GAAA,CAAAC,IAAA;QACAN,CAAA,CAAAhB,IAAA,GAAAqB,GAAA,CAAArB,IAAA;QACAuB,OAAA,CAAAC,GAAA,MAAA7B,UAAA;MACA,GACA8B,KAAA,CAAAC,GAAA;QACAC,KAAA,CAAAD,GAAA;MACA;IACA;IACA;IACAE,GAAA;MACA,KAAAC,OAAA,CAAAC,EAAA;IACA;IACAC,KAAA;MACA,KAAAC,QAAA;QACAC,OAAA;QACAC,IAAA;MACA;IACA;IACA;IACAC,aAAAC,GAAA,EAAAC,OAAA;MACAd,OAAA,CAAAC,GAAA,CAAAY,GAAA,EAAAC,OAAA;IACA;IACA;IACAC,sBAAAC,GAAA;MACA,KAAArC,iBAAA,GAAAqC,GAAA;MACAhB,OAAA,CAAAC,GAAA,MAAAtB,iBAAA;IACA;IACAsC,IAAA;MACA,IAAAC,EAAA,QAAAxB,MAAA,CAAAC,KAAA,CAAAhC,EAAA;MAEAhB,KAAA,CACAwE,GAAA,CACA,oEAAAD,EACA,EACArB,IAAA,CAAAC,GAAA;QACA,KAAApC,UAAA,CAAAC,EAAA,GAAAmC,GAAA,CAAAsB,cAAA;QAEA,KAAA1D,UAAA,CAAAE,EAAA,GAAAkC,GAAA,CAAAuB,cAAA;QACA,KAAA3D,UAAA,CAAAG,EAAA,GAAAiC,GAAA,CAAAwB,SAAA;QACA,KAAA5D,UAAA,CAAAb,IAAA,GAAAiD,GAAA,CAAAyB,QAAA;QACA,KAAA7D,UAAA,CAAAO,KAAA,GAAA6B,GAAA,CAAA0B,UAAA;QACA,KAAA9D,UAAA,CAAAI,GAAA,GAAAgC,GAAA,CAAA2B,MAAA;QACA,KAAA/D,UAAA,CAAAM,EAAA,GAAA8B,GAAA,CAAA9B,EAAA;QACA,KAAAN,UAAA,CAAAK,GAAA,GAAA+B,GAAA,CAAA4B,QAAA;MACA,GACAxB,KAAA,CAAAC,GAAA;QACAC,KAAA,CAAAD,GAAA;MACA;IACA;IACA;IACAwB,KAAA;MACA,IAAAT,EAAA,QAAAxB,MAAA,CAAAC,KAAA,CAAAhC,EAAA;MAEA,IAAAiE,EAAA;MACA,IAAAC,EAAA;MACA,IAAAC,EAAA;MACA,IAAAC,EAAA;MACA,IAAAC,EAAA;MACA,IAAAC,EAAA;MACA,IAAAC,EAAA;MACA,IAAAC,EAAA;;MAEAxF,KAAA,CACAwE,GAAA,CACA,oEAAAD,EACA,EACArB,IAAA,CAAAC,GAAA;QACA,KAAA5B,SAAA,GAAA4B,GAAA;QACA,SAAAX,CAAA,MAAAA,CAAA,QAAAjB,SAAA,CAAAe,MAAA,EAAAE,CAAA;UACAyC,EAAA,SAAA1D,SAAA,CAAAiB,CAAA,EAAAiD,WAAA;UACAP,EAAA,SAAA3D,SAAA,CAAAiB,CAAA,EAAAkD,aAAA;UACAL,EAAA,IACA,KAAA9D,SAAA,CAAAiB,CAAA,EAAAiD,WAAA,QAAAlE,SAAA,CAAAiB,CAAA,EAAAmD,YAAA;UACAL,EAAA,IACA,KAAA/D,SAAA,CAAAiB,CAAA,EAAAkD,aAAA,QAAAnE,SAAA,CAAAiB,CAAA,EAAAmD,YAAA;UACA,SAAApE,SAAA,CAAAiB,CAAA,EAAAoD,cAAA;YACAT,EAAA,SAAA5D,SAAA,CAAAiB,CAAA,EAAAoD,cAAA;YACAL,EAAA,IACA,KAAAhE,SAAA,CAAAiB,CAAA,EAAAoD,cAAA,GACA,KAAArE,SAAA,CAAAiB,CAAA,EAAAmD,YAAA;UACA;UACA,SAAApE,SAAA,CAAAiB,CAAA,EAAAoD,cAAA;YACAR,EAAA,SAAA7D,SAAA,CAAAiB,CAAA,EAAAoD,cAAA;YACAJ,EAAA,IACA,KAAAjE,SAAA,CAAAiB,CAAA,EAAAoD,cAAA,GACA,KAAArE,SAAA,CAAAiB,CAAA,EAAAmD,YAAA;UACA;QACA;QACAE,QAAA,CAAAC,cAAA,cAAAC,SAAA,GAAAb,EAAA;QACAW,QAAA,CAAAC,cAAA,UAAAC,SAAA,GAAAd,EAAA;QACAY,QAAA,CAAAC,cAAA,WAAAC,SAAA,GAAAV,EAAA;QACAQ,QAAA,CAAAC,cAAA,cAAAC,SAAA,GAAAT,EAAA;QACAO,QAAA,CAAAC,cAAA,eAAAC,SAAA,GAAAZ,EAAA;QACAU,QAAA,CAAAC,cAAA,eAAAC,SAAA,GAAAX,EAAA;QACAS,QAAA,CAAAC,cAAA,eAAAC,SAAA,GAAAR,EAAA;QACAM,QAAA,CAAAC,cAAA,eAAAC,SAAA,GAAAP,EAAA;MACA,GACAjC,KAAA,CAAAC,GAAA;QACAC,KAAA,CAAAD,GAAA;MACA;MAEAxD,KAAA,CACAiD,IAAA,CACA,gFACAsB,EAAA,GACA,GACA,EACArB,IAAA,CAAAC,GAAA;QACA,KAAA3B,UAAA,GAAA2B,GAAA,CAAAC,IAAA;MACA,GACAG,KAAA,CAAAC,GAAA;QACAC,KAAA,CAAAD,GAAA;MACA;MAEAxD,KAAA,CACAiD,IAAA,CACA,oFACAsB,EAAA,GACA,GACA,EACArB,IAAA,CAAAC,GAAA;QACA,KAAAzB,UAAA,GAAAyB,GAAA,CAAAC,IAAA;MACA,GACAG,KAAA,CAAAC,GAAA;QACAC,KAAA,CAAAD,GAAA;MACA;IACA;IAEA;IACAwC,WAAAC,SAAA;MACA,OAAAhG,UAAA,CAAAgG,SAAA;IACA;IACAC,YAAAC,GAAA,EAAAC,KAAA;MACA/C,OAAA,CAAAC,GAAA,CAAA6C,GAAA,EAAAC,KAAA;IACA;EACA;EACAC,QAAA;IACA,KAAA/B,GAAA;IACA,KAAAU,IAAA;IACA,KAAArC,KAAA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}