{"ast":null,"code":"import $http from \"../http/base.js\";\nexport default {\n  data() {\n    return {\n      dialogFormVisible: false,\n      desc: \"\",\n      resource: \"\",\n      str: \"1=1\",\n      tableloading: false,\n      //加载\n      showDefaultAttr: true,\n      multipleSelection: [],\n      // 选中的行数据\n      formInline: {\n        dh: \"\",\n        lx: \"\",\n        ztai: \"\",\n        mc: \"\"\n      },\n      countryList: [],\n      tableData: [],\n      currentPage: 1,\n      //当前页\n      pagesize: 10,\n      //每页显示数\n      rows: 0,\n      //总行数\n      id: 0,\n      ii: \"\"\n    };\n  },\n  methods: {\n    updateTextBox(i) {\n      this.desc = i === \"2\" ? \"通过\" : \"驳回\";\n    },\n    //导出\n    daochu() {},\n    //导入\n    daoru() {},\n    //取消审核\n    qx() {\n      this.dialogFormVisible = false;\n      this.resource = \"\";\n      this.desc = \"\";\n    },\n    //确定审核\n    qd() {\n      var user = localStorage.getItem(\"name\");\n      $http.put(\"http://localhost:5149/api/Wh_inventory_h/Wh_inventory_hSH?name=\" + user + \"&zt=\" + this.resource + \"&desc=\" + this.desc + \"&ii=\" + this.ii).then(res => {\n        if (res) {\n          this.$message({\n            message: \"审核成功！\",\n            type: \"success\"\n          });\n          this.dialogFormVisible = false;\n          this.resource = \"\";\n          this.desc = \"\";\n          this.FenYe();\n        }\n      }).catch(err => {\n        alert(err);\n      });\n    },\n    //审核\n    sh() {\n      if (this.multipleSelection.length == 0) {\n        this.$notify.error({\n          title: \"错误\",\n          message: \"请选择要进行审核的数据\"\n        });\n        return;\n      }\n      for (let i = 0; i < this.multipleSelection.length; i++) {\n        var zt = this.multipleSelection[i].sure_state;\n        var ii = this.multipleSelection[i].inventory_code;\n      }\n      this.ii = ii;\n      if (zt == 0) {\n        this.dialogFormVisible = true;\n      } else if (zt == 1) {\n        this.$message({\n          message: \"无法执行该操作\",\n          type: \"warning\"\n        });\n        return;\n      } else if (zt == 2) {\n        this.$message({\n          message: \"无法执行该操作\",\n          type: \"warning\"\n        });\n        return;\n      }\n    },\n    //仓库下拉框\n    CK() {\n      var t = this;\n      $http.get(\"http://localhost:5149/api/Bs_warehouse/Bs_warehouseSelect1\").then(res => {\n        t.countryList = res;\n      }).catch(err => {\n        alert(err);\n      });\n    },\n    //新增\n    insert() {\n      this.$router.push(\"/AddWh_inventory_h\");\n    },\n    //编辑\n    handleEdit(i) {\n      if (i.sure_state != 0) {\n        this.$message({\n          message: \"无权限操作\",\n          type: \"warning\"\n        });\n        return;\n      }\n      this.$router.push(\"/UpdateWh_inventory_h?dh=\" + i.inventory_code);\n    },\n    truncateString(str, length) {\n      return str.length > length ? str.slice(0, length) + \"...\" : str;\n    },\n    //查询方法\n    FenYe() {\n      var t = this;\n      $http.post(\"http://localhost:5149/api/Wh_inventory_h/Fen?page=\" + t.pagesize + \"&pageSize=\" + t.currentPage + \"&str=\" + t.str).then(res => {\n        t.tableData = res.list;\n        t.rows = res.rows;\n      }).catch(err => {\n        alert(err);\n      });\n    },\n    filterTime(timestamp) {\n      return formatDate(timestamp);\n    },\n    zt(i) {\n      if (i == 0) return \"无盈亏\";\n      if (i == 1) return \"有盈亏\";\n    },\n    //重置\n    reset() {\n      this.formInline = {\n        dh: \"\",\n        ztai: \"\",\n        mc: \"\",\n        lx: \"\"\n      };\n    },\n    //搜索\n    search() {\n      this.currentPage = 1;\n      this.str = \"1=1\";\n      if (this.formInline.dh != \"\") {\n        this.str += \" AND inventory_code like CONCAT('%','\" + this.formInline.dh + \"','%') \";\n      }\n      if (this.formInline.lx != \"\") {\n        this.str += \" AND inventory_type like CONCAT('%','\" + this.formInline.lx + \"','%') \";\n      }\n      if (this.formInline.ztai != \"\") {\n        this.str += \" AND zt like CONCAT('%','\" + this.formInline.ztai + \"','%') \";\n      }\n      if (this.formInline.mc != \"\") {\n        this.str += \" AND ware_code like CONCAT('%','\" + this.formInline.mc + \"','%') \";\n      }\n      this.FenYe();\n    },\n    //选择\n    handleSelectionChange(val) {\n      this.multipleSelection = val;\n      console.log(this.multipleSelection);\n    },\n    //删除\n    handleDelete(i) {\n      if (i.sure_state == 2) {\n        this.$message({\n          message: \"无权限操作\",\n          type: \"warning\"\n        });\n        return;\n      }\n      this.$confirm(\"此操作将永久删除该信息, 是否继续?\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(() => {\n        $http.put(\"   http://localhost:5149/api/Wh_inventory_h/Wh_inventory_hDelete?addStudenDto=\" + i.inventory_code).then(res => {\n          if (res) {\n            this.$message({\n              message: \"删除成功！\",\n              type: \"success\"\n            });\n            this.FenYe();\n          }\n        }).catch(err => {\n          alert(err);\n        });\n      }).catch(() => {\n        this.$message({\n          type: \"error\",\n          message: \"已取消删除\"\n        });\n      });\n    },\n    //每页显示数改变事件\n    handleSizeChange(size) {\n      this.pagesize = size;\n      this.currentPage = 1;\n      this.FenYe();\n    },\n    //页码改变事件\n    handleCurrentChange(page) {\n      this.currentPage = page;\n      this.FenYe();\n    },\n    //刷新table\n    flushed() {\n      this.tableloading = true;\n      // 模拟获取接口数据\n      setTimeout(() => {\n        //调用find();this.find();\n        this.tableloading = false;\n      }, 1000);\n      //直接this.查询方法();\n    },\n\n    //批量删除\n    delAll() {\n      var strs = [];\n      for (let i = 0; i < this.multipleSelection.length; i++) {\n        strs.push(this.multipleSelection[i].inventory_h_id);\n        if (this.multipleSelection[i].sure_state == 2) {\n          this.$message({\n            message: \"请选择正确的记录\",\n            type: \"warning\"\n          });\n          return;\n        }\n      }\n      console.log(this.multipleSelection);\n      $http.put(\" http://localhost:5149/api/Wh_inventory_h/Wh_inventory_hDeleteS/route\", strs).then(res => {\n        if (res) {\n          this.$message({\n            message: \"删除成功！\",\n            type: \"success\"\n          });\n          this.FenYe();\n        }\n      }).catch(err => {\n        alert(err);\n      });\n    }\n  },\n  mounted() {\n    this.tableloading = true;\n    // 模拟获取接口数据\n    setTimeout(() => {\n      this.FenYe();\n      this.tableloading = false;\n    }, 500);\n    this.CK();\n  }\n};\nexport function formatDate(date) {\n  let time = new Date(date);\n  let year = time.getFullYear();\n  let month = time.getMonth() + 1;\n  month = month.toString().padStart(2, \"0\");\n  let day = time.getDate().toString().padStart(2, \"0\");\n  let hours = time.getHours().toString().padStart(2, \"0\");\n  let minutes = time.getMinutes().toString().padStart(2, \"0\");\n  let seconds = time.getSeconds().toString().padStart(2, \"0\");\n  return year + \"/\" + month + \"/\" + day + \"/\" + \" \" + hours + \":\" + minutes + \":\" + seconds;\n}","map":{"version":3,"names":["$http","data","dialogFormVisible","desc","resource","str","tableloading","showDefaultAttr","multipleSelection","formInline","dh","lx","ztai","mc","countryList","tableData","currentPage","pagesize","rows","id","ii","methods","updateTextBox","i","daochu","daoru","qx","qd","user","localStorage","getItem","put","then","res","$message","message","type","FenYe","catch","err","alert","sh","length","$notify","error","title","zt","sure_state","inventory_code","CK","t","get","insert","$router","push","handleEdit","truncateString","slice","post","list","filterTime","timestamp","formatDate","reset","search","handleSelectionChange","val","console","log","handleDelete","$confirm","confirmButtonText","cancelButtonText","handleSizeChange","size","handleCurrentChange","page","flushed","setTimeout","delAll","strs","inventory_h_id","mounted","date","time","Date","year","getFullYear","month","getMonth","toString","padStart","day","getDate","hours","getHours","minutes","getMinutes","seconds","getSeconds"],"sources":["src/components/Wh_inventory_h.vue"],"sourcesContent":["<template>\r\n  <div id=\"kj\">\r\n    <!--头部-->\r\n    <el-breadcrumb separator=\"/\" id=\"card\">\r\n      <el-breadcrumb-item :to=\"{ path: '/Home' }\">首页</el-breadcrumb-item>\r\n      <el-breadcrumb-item\r\n        ><a href=\"javascript:void(0)\">出入库管理</a></el-breadcrumb-item\r\n      >\r\n      <el-breadcrumb-item>库存盘点</el-breadcrumb-item>\r\n    </el-breadcrumb>\r\n    <!--搜索-->\r\n\r\n    <transition-group name=\"lyric\">\r\n      <div id=\"form\" v-if=\"showDefaultAttr\" key=\"1\">\r\n        <el-form :inline=\"true\" :model=\"formInline\" class=\"demo-form-inline\">\r\n          <el-form-item label=\"盘点单号\">\r\n            <el-input\r\n              v-model=\"formInline.dh\"\r\n              id=\"tex\"\r\n              placeholder=\"请输入\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"盘点类型\">\r\n            <el-select\r\n              v-model=\"formInline.lx\"\r\n              id=\"tex\"\r\n              clearable\r\n              filterable\r\n              placeholder=\"请选择\"\r\n            >\r\n              <el-option label=\"期初盘点\" value=\"期初盘点\"></el-option>\r\n              <el-option label=\"存货盘点\" value=\"存货盘点\"></el-option>\r\n              <el-option label=\"期末盘点\" value=\"期末盘点\"></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n\r\n          <el-form-item label=\"盘点结果\">\r\n            <el-select\r\n              v-model=\"formInline.ztai\"\r\n              id=\"tex\"\r\n              clearable\r\n              filterable\r\n              placeholder=\"请选择\"\r\n            >\r\n              <el-option label=\"无盈亏\" value=\"0\"></el-option>\r\n              <el-option label=\"有盈亏\" value=\"1\"></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item label=\"仓库名称\">\r\n            <el-select\r\n              v-model=\"formInline.mc\"\r\n              id=\"tex\"\r\n              clearable\r\n              filterable\r\n              placeholder=\"请选择\"\r\n            >\r\n              <el-option\r\n                v-for=\"item in countryList\"\r\n                :key=\"item.warehouse_id\"\r\n                :label=\"item.ware_name\"\r\n                :value=\"item.ware_name\"\r\n              ></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n\r\n          <el-form-item id=\"w\">\r\n            <el-button\r\n              @click=\"search()\"\r\n              type=\"primary\"\r\n              id=\"tex1\"\r\n              icon=\"el-icon-search\"\r\n              >搜索</el-button\r\n            >\r\n            <el-button @click=\"reset()\" id=\"tex2\" icon=\"el-icon-refresh\"\r\n              >重置</el-button\r\n            >\r\n            <!-- <el-button type=\"primary\" @click=\"search\">高级搜索</el-button> -->\r\n          </el-form-item>\r\n        </el-form>\r\n      </div>\r\n    </transition-group>\r\n\r\n    <!--按钮-->\r\n    <div id=\"an\">\r\n      <el-button id=\"tex3\" icon=\"el-icon-plus\" @click=\"insert()\"\r\n        >新增</el-button\r\n      >\r\n      <!-- <el-button  id=\"tex4\"  icon=\"el-icon-edit\">修改</el-button> -->\r\n      <el-button\r\n        id=\"tex5\"\r\n        @click=\"delAll()\"\r\n        icon=\"el-icon-delete\"\r\n        :disabled=\"multipleSelection.length == 0\"\r\n        >删除</el-button\r\n      >\r\n      <el-button\r\n        id=\"tex7\"\r\n        :disabled=\"multipleSelection.length > 1\"\r\n        @click=\"sh()\"\r\n        icon=\"el-icon-setting\"\r\n        >审核</el-button\r\n      >\r\n    </div>\r\n\r\n    <!--隐藏-->\r\n    <div id=\"an1\">\r\n      <el-button\r\n        icon=\"el-icon-upload\"\r\n        circle\r\n        @click=\"daoru\"\r\n        title=\"导入\"\r\n      ></el-button>\r\n      <el-button\r\n        icon=\"el-icon-download\"\r\n        circle\r\n        @click=\"daochu\"\r\n        title=\"导出\"\r\n      ></el-button>\r\n\r\n      <el-button\r\n        icon=\"el-icon-search\"\r\n        circle\r\n        @click=\"showDefaultAttr = !showDefaultAttr\"\r\n        title=\"展开\"\r\n      ></el-button>\r\n      <el-button\r\n        icon=\"el-icon-refresh\"\r\n        circle\r\n        @click=\"flushed\"\r\n        title=\"刷新\"\r\n      ></el-button>\r\n    </div>\r\n    <!-- 表单 -->\r\n    <el-table\r\n      height=\"450px\"\r\n      tooltip-effect=\"dark\"\r\n      v-loading=\"tableloading\"\r\n      @selection-change=\"handleSelectionChange\"\r\n      :data=\"tableData\"\r\n      :header-cell-style=\"{ background: '#F8F8F9', color: '#606266' }\"\r\n      id=\"tableMain\"\r\n      element-loading-text=\"拼命加载中\"\r\n      element-loading-spinner=\"el-icon-loading\"\r\n    >\r\n      <el-table-column type=\"selection\" width=\"55\"> </el-table-column>\r\n\r\n      <el-table-column fixed prop=\"outbill_code\" label=\"盘点单号\" width=\"120\">\r\n        <template slot-scope=\"{ row }\">\r\n          <router-link\r\n            :to=\"{\r\n              name: 'DetaileWh_inventory_h',\r\n              query: { dh: row.inventory_code },\r\n            }\"\r\n            style=\"color: #9c27b0\"\r\n            >{{ row.inventory_code }}</router-link\r\n          >\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column fixed label=\"盘点结果\" width=\"100\">\r\n        <template slot-scope=\"scope\">\r\n          <span>{{ zt(scope.row.zt) }}</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column fixed label=\"状态\" width=\"100\">\r\n        <template slot-scope=\"scope\">\r\n          <span\r\n            v-if=\"scope.row.sure_state == 0\"\r\n            style=\"color: blue; font-weight: 600; font-size: 13px\"\r\n            >待审核</span\r\n          >\r\n          <span\r\n            v-if=\"scope.row.sure_state == 1\"\r\n            style=\"color: red; font-weight: 600; font-size: 13px\"\r\n            >驳回</span\r\n          >\r\n          <span\r\n            v-if=\"scope.row.sure_state == 2\"\r\n            style=\"color: green; font-weight: 600; font-size: 13px\"\r\n            >已完成</span\r\n          >\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"ware_code\" label=\"仓库名称\" width=\"120\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"inventory_type\" label=\"盘点类型\" width=\"120\">\r\n      </el-table-column>\r\n      <el-table-column label=\"盘点开始时间\" width=\"180\">\r\n        <template slot-scope=\"scope\">\r\n          <span>{{ filterTime(scope.row.begin_date) }}</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"盘点结束时间\" width=\"180\">\r\n        <template slot-scope=\"scope\">\r\n          <span>{{ filterTime(scope.row.end_date) }}</span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column prop=\"names\" label=\"盘点货品\" width=\"180\">\r\n        <template slot-scope=\"scope\">\r\n          <el-popover placement=\"top\" trigger=\"hover\">\r\n            <p>{{ scope.row.names }}</p>\r\n            <div slot=\"reference\">\r\n              {{ truncateString(scope.row.names, 10) }}\r\n            </div>\r\n          </el-popover>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column prop=\"total_buy_num\" label=\"盘点数量\" width=\"120\">\r\n      </el-table-column>\r\n      <el-table-column label=\"盘盈数量\" width=\"120\">\r\n        <template slot-scope=\"scope\">\r\n          <span style=\"color: green\">{{ scope.row.total_y_num }}</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"盘亏数量\" width=\"120\">\r\n        <template slot-scope=\"scope\">\r\n          <span style=\"color: red\">{{ scope.row.total_k_num }}</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"total_price\" label=\"盘点金额\" width=\"120\">\r\n      </el-table-column>\r\n      <el-table-column label=\"盘盈金额\" width=\"120\">\r\n        <template slot-scope=\"scope\">\r\n          <span style=\"color: green\">{{ scope.row.total_y_price }}</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"\" label=\"盘亏金额\" width=\"120\">\r\n        <template slot-scope=\"scope\">\r\n          <span style=\"color: red\">{{ scope.row.total_k_price }}</span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column prop=\"create_by\" label=\"制单人\" width=\"120\">\r\n      </el-table-column>\r\n      <el-table-column label=\"制单时间\" width=\"170\">\r\n        <template slot-scope=\"scope\">\r\n          <span>{{ filterTime(scope.row.create_time) }}</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"sure_man\" label=\"经办人\" width=\"120\">\r\n      </el-table-column>\r\n\r\n      <el-table-column label=\"审核时间\" width=\"170\">\r\n        <template slot-scope=\"scope\">\r\n          <span v-if=\"scope.row.sure_date != '0001-01-01T00:00:00'\">{{\r\n            filterTime(scope.row.sure_date)\r\n          }}</span>\r\n          <span v-else></span>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column label=\"操作\" fixed=\"right\" width=\"100\">\r\n        <template slot-scope=\"scope\">\r\n          <img\r\n            src=\"../Images/bianji1.png\"\r\n            title=\"编辑\"\r\n            width=\"25px\"\r\n            height=\"25px\"\r\n            @click=\"handleEdit(scope.row)\"\r\n          />\r\n          <img\r\n            src=\"../Images/shanchu.png\"\r\n            width=\"28px\"\r\n            height=\"28px\"\r\n            style=\"margin-left: 5px\"\r\n            title=\"删除\"\r\n            @click=\"handleDelete(scope.row)\"\r\n          />\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 分页 -->\r\n    <el-pagination\r\n      id=\"fenye\"\r\n      @size-change=\"handleSizeChange\"\r\n      @current-change=\"handleCurrentChange\"\r\n      :current-page=\"currentPage\"\r\n      :page-sizes=\"[10, 20, 30, 40]\"\r\n      :page-size=\"pagesize\"\r\n      layout=\"total, sizes, prev, pager, next, jumper\"\r\n      :total=\"rows\"\r\n    >\r\n    </el-pagination>\r\n\r\n    <!-- 审核 -->\r\n    <el-dialog\r\n      title=\"审核\"\r\n      :visible.sync=\"dialogFormVisible\"\r\n      width=\"430px\"\r\n      id=\"tjshh\"\r\n    >\r\n      <el-form style=\"height: 225px\">\r\n        <el-form-item label=\"审核结果\">\r\n          <el-radio-group v-model=\"resource\" id=\"dx\" @change=\"updateTextBox\">\r\n            <el-radio v-model=\"resource\" label=\"2\" value=\"2\">通过</el-radio>\r\n            <el-radio label=\"1\" value=\"1\">驳回</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"审核意见\">\r\n          <el-input type=\"textarea\" id=\"yj\" v-model=\"desc\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button id=\"gb1\" @click=\"qx()\">取 消</el-button>\r\n        <el-button\r\n          id=\"bc12\"\r\n          style=\"background-color: #9c27b0; color: #fff\"\r\n          @click=\"qd()\"\r\n          >确 定</el-button\r\n        >\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport $http from \"../http/base.js\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      dialogFormVisible: false,\r\n      desc: \"\",\r\n      resource: \"\",\r\n      str: \"1=1\",\r\n      tableloading: false, //加载\r\n      showDefaultAttr: true,\r\n      multipleSelection: [], // 选中的行数据\r\n      formInline: {\r\n        dh: \"\",\r\n        lx: \"\",\r\n        ztai: \"\",\r\n        mc: \"\",\r\n      },\r\n      countryList: [],\r\n      tableData: [],\r\n      currentPage: 1, //当前页\r\n      pagesize: 10, //每页显示数\r\n      rows: 0, //总行数\r\n      id: 0,\r\n      ii: \"\",\r\n    };\r\n  },\r\n  methods: {\r\n    updateTextBox(i) {\r\n      this.desc = i === \"2\" ? \"通过\" : \"驳回\";\r\n    },\r\n    //导出\r\n    daochu() {},\r\n    //导入\r\n    daoru() {},\r\n    //取消审核\r\n    qx() {\r\n      this.dialogFormVisible = false;\r\n\r\n      this.resource = \"\";\r\n      this.desc = \"\";\r\n    },\r\n    //确定审核\r\n    qd() {\r\n      var user = localStorage.getItem(\"name\");\r\n      $http\r\n        .put(\r\n          \"http://localhost:5149/api/Wh_inventory_h/Wh_inventory_hSH?name=\" +\r\n            user +\r\n            \"&zt=\" +\r\n            this.resource +\r\n            \"&desc=\" +\r\n            this.desc +\r\n            \"&ii=\" +\r\n            this.ii\r\n        )\r\n        .then((res) => {\r\n          if (res) {\r\n            this.$message({\r\n              message: \"审核成功！\",\r\n              type: \"success\",\r\n            });\r\n            this.dialogFormVisible = false;\r\n            this.resource = \"\";\r\n            this.desc = \"\";\r\n            this.FenYe();\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          alert(err);\r\n        });\r\n    },\r\n    //审核\r\n    sh() {\r\n      if (this.multipleSelection.length == 0) {\r\n        this.$notify.error({\r\n          title: \"错误\",\r\n          message: \"请选择要进行审核的数据\",\r\n        });\r\n        return;\r\n      }\r\n\r\n      for (let i = 0; i < this.multipleSelection.length; i++) {\r\n        var zt = this.multipleSelection[i].sure_state;\r\n        var ii = this.multipleSelection[i].inventory_code;\r\n      }\r\n\r\n      this.ii = ii;\r\n      if (zt == 0) {\r\n        this.dialogFormVisible = true;\r\n      } else if (zt == 1) {\r\n        this.$message({\r\n          message: \"无法执行该操作\",\r\n          type: \"warning\",\r\n        });\r\n        return;\r\n      } else if (zt == 2) {\r\n        this.$message({\r\n          message: \"无法执行该操作\",\r\n          type: \"warning\",\r\n        });\r\n        return;\r\n      }\r\n    },\r\n\r\n    //仓库下拉框\r\n    CK() {\r\n      var t = this;\r\n      $http\r\n        .get(\"http://localhost:5149/api/Bs_warehouse/Bs_warehouseSelect1\")\r\n        .then((res) => {\r\n          t.countryList = res;\r\n        })\r\n        .catch((err) => {\r\n          alert(err);\r\n        });\r\n    },\r\n    //新增\r\n    insert() {\r\n      this.$router.push(\"/AddWh_inventory_h\");\r\n    },\r\n    //编辑\r\n    handleEdit(i) {\r\n      if (i.sure_state != 0) {\r\n        this.$message({\r\n          message: \"无权限操作\",\r\n          type: \"warning\",\r\n        });\r\n        return;\r\n      }\r\n      this.$router.push(\"/UpdateWh_inventory_h?dh=\" + i.inventory_code);\r\n    },\r\n    truncateString(str, length) {\r\n      return str.length > length ? str.slice(0, length) + \"...\" : str;\r\n    },\r\n\r\n    //查询方法\r\n    FenYe() {\r\n      var t = this;\r\n      $http\r\n        .post(\r\n          \"http://localhost:5149/api/Wh_inventory_h/Fen?page=\" +\r\n            t.pagesize +\r\n            \"&pageSize=\" +\r\n            t.currentPage +\r\n            \"&str=\" +\r\n            t.str\r\n        )\r\n        .then((res) => {\r\n          t.tableData = res.list;\r\n          t.rows = res.rows;\r\n        })\r\n        .catch((err) => {\r\n          alert(err);\r\n        });\r\n    },\r\n    filterTime(timestamp) {\r\n      return formatDate(timestamp);\r\n    },\r\n    zt(i) {\r\n      if (i == 0) return \"无盈亏\";\r\n      if (i == 1) return \"有盈亏\";\r\n    },\r\n    //重置\r\n    reset() {\r\n      this.formInline = {\r\n        dh: \"\",\r\n        ztai: \"\",\r\n        mc: \"\",\r\n        lx: \"\",\r\n      };\r\n    },\r\n\r\n    //搜索\r\n    search() {\r\n      this.currentPage = 1;\r\n\r\n      this.str = \"1=1\";\r\n      if (this.formInline.dh != \"\") {\r\n        this.str +=\r\n          \" AND inventory_code like CONCAT('%','\" +\r\n          this.formInline.dh +\r\n          \"','%') \";\r\n      }\r\n      if (this.formInline.lx != \"\") {\r\n        this.str +=\r\n          \" AND inventory_type like CONCAT('%','\" +\r\n          this.formInline.lx +\r\n          \"','%') \";\r\n      }\r\n      if (this.formInline.ztai != \"\") {\r\n        this.str +=\r\n          \" AND zt like CONCAT('%','\" + this.formInline.ztai + \"','%') \";\r\n      }\r\n      if (this.formInline.mc != \"\") {\r\n        this.str +=\r\n          \" AND ware_code like CONCAT('%','\" + this.formInline.mc + \"','%') \";\r\n      }\r\n\r\n      this.FenYe();\r\n    },\r\n    //选择\r\n    handleSelectionChange(val) {\r\n      this.multipleSelection = val;\r\n      console.log(this.multipleSelection);\r\n    },\r\n    //删除\r\n    handleDelete(i) {\r\n      if (i.sure_state == 2) {\r\n        this.$message({\r\n          message: \"无权限操作\",\r\n          type: \"warning\",\r\n        });\r\n        return;\r\n      }\r\n      this.$confirm(\"此操作将永久删除该信息, 是否继续?\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\",\r\n      })\r\n        .then(() => {\r\n          $http\r\n            .put(\r\n              \"   http://localhost:5149/api/Wh_inventory_h/Wh_inventory_hDelete?addStudenDto=\" +\r\n                i.inventory_code\r\n            )\r\n            .then((res) => {\r\n              if (res) {\r\n                this.$message({\r\n                  message: \"删除成功！\",\r\n                  type: \"success\",\r\n                });\r\n                this.FenYe();\r\n              }\r\n            })\r\n            .catch((err) => {\r\n              alert(err);\r\n            });\r\n        })\r\n        .catch(() => {\r\n          this.$message({\r\n            type: \"error\",\r\n            message: \"已取消删除\",\r\n          });\r\n        });\r\n    },\r\n    //每页显示数改变事件\r\n    handleSizeChange(size) {\r\n      this.pagesize = size;\r\n      this.currentPage = 1;\r\n      this.FenYe();\r\n    },\r\n    //页码改变事件\r\n    handleCurrentChange(page) {\r\n      this.currentPage = page;\r\n      this.FenYe();\r\n    },\r\n    //刷新table\r\n    flushed() {\r\n      this.tableloading = true;\r\n      // 模拟获取接口数据\r\n      setTimeout(() => {\r\n        //调用find();this.find();\r\n        this.tableloading = false;\r\n      }, 1000);\r\n      //直接this.查询方法();\r\n    },\r\n    //批量删除\r\n    delAll() {\r\n      var strs = [];\r\n      for (let i = 0; i < this.multipleSelection.length; i++) {\r\n        strs.push(this.multipleSelection[i].inventory_h_id);\r\n        if (this.multipleSelection[i].sure_state == 2) {\r\n          this.$message({\r\n            message: \"请选择正确的记录\",\r\n            type: \"warning\",\r\n          });\r\n          return;\r\n        }\r\n      }\r\n      console.log(this.multipleSelection);\r\n      $http\r\n        .put(\r\n          \" http://localhost:5149/api/Wh_inventory_h/Wh_inventory_hDeleteS/route\",\r\n          strs\r\n        )\r\n        .then((res) => {\r\n          if (res) {\r\n            this.$message({\r\n              message: \"删除成功！\",\r\n              type: \"success\",\r\n            });\r\n            this.FenYe();\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          alert(err);\r\n        });\r\n    },\r\n  },\r\n  mounted() {\r\n    this.tableloading = true;\r\n    // 模拟获取接口数据\r\n    setTimeout(() => {\r\n      this.FenYe();\r\n      this.tableloading = false;\r\n    }, 500);\r\n\r\n    this.CK();\r\n  },\r\n};\r\nexport function formatDate(date) {\r\n  let time = new Date(date);\r\n\r\n  let year = time.getFullYear();\r\n\r\n  let month = time.getMonth() + 1;\r\n  month = month.toString().padStart(2, \"0\");\r\n  let day = time.getDate().toString().padStart(2, \"0\");\r\n  let hours = time.getHours().toString().padStart(2, \"0\");\r\n  let minutes = time.getMinutes().toString().padStart(2, \"0\");\r\n  let seconds = time.getSeconds().toString().padStart(2, \"0\");\r\n  return (\r\n    year +\r\n    \"/\" +\r\n    month +\r\n    \"/\" +\r\n    day +\r\n    \"/\" +\r\n    \" \" +\r\n    hours +\r\n    \":\" +\r\n    minutes +\r\n    \":\" +\r\n    seconds\r\n  );\r\n}\r\n</script>\r\n<style scoped src=\"../CSS/public.css\"></style>\r\n<style src=\"../CSS/tableys.css\"></style>\r\n\r\n<style>\r\n#w {\r\n  margin-left: 20px;\r\n}\r\n\r\n#card {\r\n  height: 35px;\r\n  line-height: 35px;\r\n  margin-left: 20px;\r\n}\r\n\r\n#form {\r\n  margin-top: 15px;\r\n  width: 1020px;\r\n  box-shadow: 0px 1px 0px rgba(0, 0, 0, 0.2);\r\n  margin-left: 65px;\r\n}\r\n\r\n#form_top {\r\n  margin-right: 25px !important;\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.el-col-2 {\r\n  width: 30px;\r\n  text-align: center;\r\n}\r\n\r\n.el-form--inline .el-form-item__label {\r\n  float: none;\r\n  display: inline-block;\r\n  font-weight: bold;\r\n  font-size: 13px;\r\n}\r\n\r\n#tex {\r\n  width: 240px;\r\n  height: 32px;\r\n}\r\n\r\n#tex1 {\r\n  width: 28px !important;\r\n  color: #fff;\r\n  background-color: #409eff;\r\n  line-height: 28px !important;\r\n  width: 73px !important;\r\n  padding: 0px !important;\r\n  margin-left: 20px;\r\n}\r\n\r\n#tex2 {\r\n  width: 28px !important;\r\n  color: #000;\r\n  background-color: #fff;\r\n  line-height: 28px !important;\r\n  width: 73px !important;\r\n  padding: 0px !important;\r\n}\r\n\r\n#tex3 {\r\n  border: 1px solid #add2fb;\r\n  color: #448ef8;\r\n  background-color: #eaf4fe;\r\n  width: 28px !important;\r\n  line-height: 28px !important;\r\n  width: 73px !important;\r\n  padding: 0px !important;\r\n  margin-left: 20px;\r\n}\r\n\r\n#tex4 {\r\n  border: 1px solid #d7f4e1;\r\n  color: #8edfa8;\r\n  background-color: #ebf9f1;\r\n  width: 28px !important;\r\n  line-height: 28px !important;\r\n  width: 73px !important;\r\n  padding: 0px !important;\r\n  margin-left: 20px;\r\n}\r\n\r\n#tex5 {\r\n  border: 1px solid #f9dcdc;\r\n  color: #f29895;\r\n  background-color: #fceeed;\r\n  width: 28px !important;\r\n  line-height: 28px !important;\r\n  width: 73px !important;\r\n  padding: 0px !important;\r\n  margin-left: 20px;\r\n}\r\n\r\n#tex6 {\r\n  border: 1px solid #fae4a2;\r\n  color: #f8c341;\r\n  background-color: #fef8e8;\r\n  width: 28px !important;\r\n  line-height: 28px !important;\r\n  width: 73px !important;\r\n  padding: 0px !important;\r\n  margin-left: 20px;\r\n}\r\n\r\n#tex7 {\r\n  border: 1px solid #d3d4d6;\r\n  color: #919398;\r\n  background-color: #f4f4f5;\r\n  width: 28px !important;\r\n  line-height: 28px !important;\r\n  width: 73px !important;\r\n  padding: 0px !important;\r\n  margin-left: 20px;\r\n}\r\n\r\n#tex3:hover {\r\n  background-color: #409eff;\r\n  color: #fff;\r\n}\r\n\r\n#tex4:hover {\r\n  background-color: #5fcb71;\r\n  color: #fff;\r\n}\r\n\r\n#tex5:hover {\r\n  background-color: #ff4949;\r\n  color: #fff;\r\n}\r\n\r\n#tex6:hover {\r\n  background-color: #f5bd41;\r\n  color: #fff;\r\n}\r\n\r\n#tex7:hover {\r\n  background-color: #919398;\r\n  color: #fff;\r\n}\r\n\r\n#an1 {\r\n  float: right;\r\n  position: relative;\r\n  top: 9px;\r\n  right: 64px;\r\n}\r\n\r\n.lyric-enter,\r\n.lyric-leave-to {\r\n  opacity: 0;\r\n  transform: translateY(15px);\r\n}\r\n\r\n.lyric-enter-to,\r\n.lyric-leave {\r\n  opacity: 1;\r\n}\r\n\r\n.lyric-enter-active,\r\n.lyric-leave-active {\r\n  transition: all 0.4s ease-out;\r\n}\r\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}